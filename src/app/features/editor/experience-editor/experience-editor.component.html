<div class="editor-container">
  <mat-card class="editor-card">
    <mat-card-header>
      <mat-card-title>Work Experience</mat-card-title>
      <mat-card-subtitle>Add your professional experience</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <form [formGroup]="experienceForm" class="experience-form">
        <div formArrayName="experiences">
          <div *ngFor="let experience of experiences.controls; let i = index" 
               [formGroupName]="i" 
               class="experience-section">
            
            <mat-card class="experience-card">
              <mat-card-header>
                <mat-card-title>Experience #{{ i + 1 }}</mat-card-title>
                <button mat-icon-button 
                        type="button" 
                        color="warn" 
                        (click)="removeExperience(i)"
                        *ngIf="experiences.length > 1">
                  <mat-icon>delete</mat-icon>
                </button>
              </mat-card-header>
              
              <mat-card-content>
                <!-- Basic Information -->
                <div class="form-section">
                  <h3>Position Details</h3>
                  <div class="form-row">
                    <mat-form-field appearance="outline" class="half-width">
                      <mat-label>Job Title</mat-label>
                      <input matInput formControlName="position" placeholder="Software Developer">
                      <mat-error *ngIf="experience.get('position')?.hasError('required')">
                        Job title is required
                      </mat-error>
                    </mat-form-field>
                    
                    <mat-form-field appearance="outline" class="half-width">
                      <mat-label>Company</mat-label>
                      <input matInput formControlName="company" placeholder="Tech Corp">
                      <mat-error *ngIf="experience.get('company')?.hasError('required')">
                        Company is required
                      </mat-error>
                    </mat-form-field>
                  </div>
                  
                  <div class="form-row">
                    <mat-form-field appearance="outline" class="full-width">
                      <mat-label>Location</mat-label>
                      <input matInput formControlName="location" placeholder="San Francisco, CA">
                      <mat-error *ngIf="experience.get('location')?.hasError('required')">
                        Location is required
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
                
                <!-- Dates -->
                <div class="form-section">
                  <h3>Employment Period</h3>
                  <div class="form-row">
                    <mat-form-field appearance="outline" class="half-width">
                      <mat-label>Start Date</mat-label>
                      <input matInput 
                             type="date" 
                             formControlName="startDate">
                      <mat-error *ngIf="experience.get('startDate')?.hasError('required')">
                        Start date is required
                      </mat-error>
                    </mat-form-field>
                    
                    <mat-form-field appearance="outline" 
                                  class="half-width"
                                  *ngIf="!experience.get('isCurrent')?.value">
                      <mat-label>End Date</mat-label>
                      <input matInput 
                             type="date" 
                             formControlName="endDate">
                    </mat-form-field>
                  </div>
                  
                  <mat-checkbox formControlName="isCurrent"
                               (change)="onCurrentJobChange(i, $event.checked)">
                    I currently work here
                  </mat-checkbox>
                </div>
                
                <!-- Job Description -->
                <div class="form-section">
                  <h3>Job Responsibilities</h3>
                  <div formArrayName="description">
                    <div *ngFor="let desc of getDescriptionArray(i).controls; let j = index"
                         class="description-item">
                      <div class="description-row">
                        <mat-form-field appearance="outline" class="description-field">
                          <mat-label>Responsibility {{ j + 1 }}</mat-label>
                          <textarea matInput 
                                   [formControlName]="j"
                                   rows="2"
                                   placeholder="Describe your responsibilities and achievements..."></textarea>
                        </mat-form-field>
                        
                        <button mat-icon-button 
                                type="button"
                                color="warn"
                                (click)="removeDescription(i, j)"
                                *ngIf="getDescriptionArray(i).length > 1">
                          <mat-icon>remove_circle</mat-icon>
                        </button>
                      </div>
                    </div>
                    
                    <button mat-stroked-button 
                            type="button"
                            (click)="addDescription(i)"
                            class="add-button">
                      <mat-icon>add</mat-icon>
                      Add Responsibility
                    </button>
                  </div>
                </div>
                
                <!-- Save Button -->
                <div class="form-actions">
                  <button mat-raised-button 
                          color="primary"
                          type="button"
                          (click)="saveExperience(i)"
                          [disabled]="!experience.valid">
                    Save Experience
                  </button>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
        
        <div class="add-experience-section">
          <button mat-raised-button 
                  color="accent"
                  type="button"
                  (click)="addExperience()"
                  class="add-experience-button">
            <mat-icon>add</mat-icon>
            Add Another Experience
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
